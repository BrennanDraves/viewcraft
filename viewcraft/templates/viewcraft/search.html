<div class=""search">
    <form method="get" class="viewcraft-search-form">
        {{ search_form.as_p }}
        <button type="submit">Search</button>
    </form>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
      // Find all search forms created by SearchComponent
      const searchForms = document.querySelectorAll('form.viewcraft-search-form');

      searchForms.forEach(function(form) {
          form.addEventListener('submit', function(e) {
              e.preventDefault();

              // Get all form fields
              const formData = new FormData(form);
              const searchParams = [];

              // Build encoded search string
              for (const [field, value] of formData.entries()) {
                  if (value.trim()) {
                      searchParams.push(`${field}:${encodeURIComponent(value.trim())}`);
                  }
              }

              // Build the URL
              let url = form.getAttribute('action') || window.location.pathname;
              const queryParam = '{{ search_param_name }}';

              if (searchParams.length > 0) {
                  const searchQuery = searchParams.join(',');
                  url += `?${queryParam}=${searchQuery}`;
              }

              // Navigate to the URL (causing page reload)
              window.location.href = url;
          });
      });
  });
</script>
